id: multiple-open-redirect
info:
  name: Multiple Open Redirects
  author: Your Name
  severity: high
  description: |
    This template checks for multiple open redirect vulnerabilities by testing for common patterns in URL redirection parameters that allow arbitrary external URLs to be specified.
tags:
  - open redirect
  - vulnerability
  - security
  - web
severity: high
requests:
  - method: GET
    path:
      - /
    params:
      - url
      - r
      - redirect_to
      - next
      - target
      - continue
      - return
      - go
      - to
      - link
      - navigate_to
      - jump
      - forward
      - from
      - external_url
      - external
    matchers-condition: or
    matchers:
      - type: word
        words:
          - "http"
          - "https"
          - "//"
    description: |
      The template will test multiple URL parameters for common patterns that may allow arbitrary external URLs to be specified, and check whether the parameters are vulnerable to open redirection attacks.
    tags:
      - open redirect
      - vulnerability
      - security
      - web
    attacks:
      - description: Arbitrary external URL specified in 'url' parameter
        matchers-condition: and
        matchers:
          - type: word
            words:
              - "http"
              - "https"
              - "//"
          - type: status
            status:
              - 3xx
          - type: word
            words:
              - "example.com"
        tags:
          - open redirect
          - vulnerability
          - security
          - web
      - description: Arbitrary external URL specified in 'r' parameter
        matchers-condition: and
        matchers:
          - type: word
            words:
              - "http"
              - "https"
              - "//"
          - type: status
            status:
              - 3xx
          - type: word
            words:
              - "example.com"
        tags:
          - open redirect
          - vulnerability
          - security
          - web
      - description: Arbitrary external URL specified in 'redirect_to' parameter
        matchers-condition: and
        matchers:
          - type: word
            words:
              - "http"
              - "https"
              - "//"
          - type: status
            status:
              - 3xx
          - type: word
            words:
              - "example.com"
        tags:
          - open redirect
          - vulnerability
          - security
          - web
      # continue with other params and attacks
